#OPTIMIZATION=-O2
DEBUG=-g
FLAGS=-Wall -Wextra -Wundef -Wcast-align -Wwrite-strings -Wlogical-op -Wmissing-declarations -Wredundant-decls -Wshadow -Woverloaded-virtual -Wfatal-errors -Werror -ansi -pedantic -std=c++11 -fno-rtti
CFLAGS=-c $(DEBUG) $(OPTIMIZATION) $(FLAGS)
FFLAGS=$(DEBUG) $(OPTIMIZATION) $(FLAGS)
CC=g++

all: objdir main libtoolscurl.a

objdir:
	$(DO_DIR_OBJECTS)

main: main.cpp libtoolscurl.a
	$(CC) main.cpp $(FFLAGS) $(INCLUDE) $(LIBPATH) -L ./ -ltoolscurl $(CURL_LINKAGE) -lpthread

libtoolscurl.a: obj/curl_request.o obj/exception.o obj/tools.o obj/curl_response.o
	ar rcs libtoolscurl.a obj/curl_request.o obj/exception.o obj/tools.o obj/curl_response.o

obj/curl_request.o: src/curl_request.h src/curl_request.cpp
	$(CC) $(CFLAGS) src/curl_request.cpp -o obj/curl_request.o $(INCLUDE) $(CFLAGS)

obj/curl_response.o: src/curl_response.h src/curl_response.cpp
	$(CC) $(CFLAGS) src/curl_response.cpp -o obj/curl_response.o $(INCLUDE) $(CFLAGS)

obj/exception.o: src/exception.h src/exception.cpp
	$(CC) $(CFLAGS) src/exception.cpp -o obj/exception.o $(INCLUDE) $(CFLAGS)

obj/tools.o: src/tools.h src/tools.cpp
	$(CC) $(CFLAGS) src/tools.cpp -o obj/tools.o $(INCLUDE) $(CFLAGS)

clean:
	$(DO_CLEAN)
